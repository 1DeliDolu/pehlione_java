<!doctype html>
<html lang="en" xmlns:th="https://www.thymeleaf.org">
  <body>
    <th:block th:fragment="main(mode, active)">
      <nav class="navbar navbar-expand-lg sticky-top glass">
        <div class="container py-2">
          <a class="navbar-brand fw-bold" href="/" th:href="@{/}">
            <i class="bi bi-bag-heart me-2"></i>Pehlione Shop
          </a>

          <th:block th:if="${mode == 'storefront'}">
            <button
              class="navbar-toggler"
              type="button"
              data-bs-toggle="collapse"
              data-bs-target="#navBar"
            >
              <span class="navbar-toggler-icon"></span>
            </button>

            <div id="navBar" class="collapse navbar-collapse">
              <form
                id="catalogSearchWrap"
                class="d-flex ms-lg-4 me-auto mt-3 mt-lg-0"
                role="search"
                onsubmit="return false;"
              >
                <div class="input-group">
                  <span class="input-group-text bg-white"
                    ><i class="bi bi-search"></i
                  ></span>
                  <input
                    id="searchInput"
                    class="form-control"
                    type="search"
                    placeholder="Search products (name / sku)"
                    autocomplete="off"
                  />
                </div>
              </form>

              <ul class="navbar-nav me-lg-3">
                <li class="nav-item">
                  <a
                    id="navHomeLink"
                    class="nav-link fw-semibold"
                    th:classappend="${active == 'home'} ? ' active' : ''"
                    href="/"
                    th:href="@{/}"
                    >Home</a
                  >
                </li>
                <li class="nav-item">
                  <a
                    id="navProductsLink"
                    class="nav-link fw-semibold"
                    th:classappend="${active == 'products'} ? ' active' : ''"
                    href="/products"
                    th:href="@{/products}"
                    >Products</a
                  >
                </li>
              </ul>

              <div class="d-flex gap-2 align-items-center mt-3 mt-lg-0">
                <span id="authState" class="small muted d-none"></span>

                <button
                  id="openLoginBtn"
                  class="btn btn-outline-dark"
                  type="button"
                >
                  <i class="bi bi-person-circle me-1"></i>Login
                </button>

                <div id="profileMenuWrap" class="dropdown d-none">
                  <button
                    class="btn btn-outline-dark dropdown-toggle"
                    type="button"
                    data-bs-toggle="dropdown"
                    aria-expanded="false"
                  >
                    <i class="bi bi-person-circle me-1"></i
                    ><span id="profileName">Profile</span>
                  </button>
                  <ul class="dropdown-menu dropdown-menu-end">
                    <li>
                      <h6 id="profileRolePill" class="dropdown-header">
                        ROLE_USER
                      </h6>
                    </li>
                    <li>
                      <button
                        id="openOrdersBtn"
                        class="dropdown-item"
                        type="button"
                      >
                        <i class="bi bi-receipt me-2"></i>Orders
                      </button>
                    </li>
                    <li>
                      <a class="dropdown-item" href="/adress" th:href="@{/adress}">
                        <i class="bi bi-geo-alt me-2"></i>Adress
                      </a>
                    </li>
                    <li>
                      <a class="dropdown-item" href="/karte" th:href="@{/karte}">
                        <i class="bi bi-credit-card me-2"></i>Karte
                      </a>
                    </li>
                    <li>
                      <button
                        id="openDashboardBtn"
                        class="dropdown-item"
                        type="button"
                      >
                        <i class="bi bi-speedometer2 me-2"></i>Dashboard
                      </button>
                    </li>
                    <li><hr class="dropdown-divider" /></li>
                    <li>
                      <button
                        id="logoutMenuBtn"
                        class="dropdown-item text-danger"
                        type="button"
                      >
                        <i class="bi bi-box-arrow-right me-2"></i>Logout
                      </button>
                    </li>
                  </ul>
                </div>

                <button
                  class="btn btn-dark position-relative"
                  type="button"
                  data-bs-toggle="offcanvas"
                  data-bs-target="#cartCanvas"
                >
                  <i class="bi bi-cart3 me-1"></i>Cart
                  <span
                    id="cartCount"
                    class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger"
                    >0</span
                  >
                </button>
              </div>
            </div>
          </th:block>

          <th:block th:if="${mode == 'auth'}">
            <div class="d-flex gap-2 ms-auto">
              <a class="btn btn-outline-dark" href="/" th:href="@{/}">Home</a>
              <a
                class="btn btn-outline-dark"
                th:if="${active == 'register'}"
                href="/login"
                th:href="@{/login}"
                >Login</a
              >
              <a
                class="btn btn-brand"
                th:if="${active == 'login'}"
                href="/register"
                th:href="@{/register}"
                >Register</a
              >
            </div>
          </th:block>

          <th:block th:if="${mode == 'settings'}">
            <div class="d-flex gap-2 ms-auto">
              <a class="btn btn-outline-dark" href="/" th:href="@{/}">Home</a>
              <a
                class="btn btn-outline-dark"
                href="/products"
                th:href="@{/products}"
                >Products</a
              >
              <a
                class="btn"
                th:classappend="${active == 'adress'} ? ' btn-brand' : ' btn-outline-dark'"
                href="/adress"
                th:href="@{/adress}"
                >Adress</a
              >
              <a
                class="btn"
                th:classappend="${active == 'karte'} ? ' btn-brand' : ' btn-outline-dark'"
                href="/karte"
                th:href="@{/karte}"
                >Karte</a
              >
            </div>
          </th:block>

          <th:block th:if="${mode == 'admin'}">
            <div class="d-flex gap-2 ms-auto">
              <a class="btn btn-outline-dark" href="/" th:href="@{/}">Storefront</a>
              <a
                class="btn btn-outline-dark"
                href="/swagger-ui/index.html"
                target="_blank"
                rel="noreferrer"
                >Swagger</a
              >
              <form th:action="@{/logout}" method="post" class="d-inline">
                <input
                  type="hidden"
                  th:if="${_csrf != null}"
                  th:name="${_csrf.parameterName}"
                  th:value="${_csrf.token}"
                />
                <button class="btn btn-dark" type="submit">
                  <i class="bi bi-box-arrow-right me-1"></i>Logout
                </button>
              </form>
            </div>
          </th:block>

          <th:block th:if="${mode == 'legal'}">
            <div class="d-flex gap-2 ms-auto">
              <a class="btn btn-outline-dark" href="/" th:href="@{/}">
                Back to Home
              </a>
            </div>
          </th:block>
        </div>
      </nav>
    </th:block>
  </body>
</html>
